
package ServerHttp;

import java.io.*;
import java.net.*;

public class AtiendeCommand extends Thread{
	
	private Socket clienteSocket = null;
	private CommandServerNew servidorSocket = null;
	
	public AtiendeCommand(Socket c){
		this.clienteSocket = c;
	}
	
	
	public void run(){
		try{
		PrintWriter out = new PrintWriter(clienteSocket.getOutputStream(), true);
		BufferedReader in = new BufferedReader(new InputStreamReader(clienteSocket.getInputStream()));
		String inLine, outLine;
		Control ctrl = new Control();
		out.println(ctrl.doControl(null));

		boolean matarServer = false;
		
		while ((inLine = in.readLine()) != null) {
			outLine = ctrl.doControl(inLine);
			out.println(outLine);
			if (outLine.equals("Chau."))
				break;
			if (outLine.equals("Muerte a Server")){ 
				matarServer = true;
				break;
			}
			if (outLine.equals("Conectados")){
				out.println(servidorSocket.conectados());
			}
		}
		out.close();
		in.close();
		clienteSocket.close();
		if(matarServer){
			System.out.println("El servidor se apagar√°\n");
			servidorSocket.shutdown();
			matarServer = false;
		}}
		catch (IOException e) {
			e.printStackTrace();
		}
	}

}
